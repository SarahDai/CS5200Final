{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/monkey/Documents/cs6620_db/project/CS5200Final/src/components/Search.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport Select from \"react-select\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faFilter, faHome, faSearch, faSortNumericDown } from '@fortawesome/free-solid-svg-icons';\nimport { Row, Col, Button, Alert } from \"reactstrap\";\nimport Listings from \"./Listings\";\nlet searchingBegun = false;\n\nconst sortOnPrice = listings => {\n  let sorted = [...listings];\n  sorted.sort((a, b) => {\n    let first = a['Price'].substring(1);\n    let second = b['Price'].substring(1);\n    return parseFloat(first) - parseFloat(second);\n  });\n  return sorted;\n};\n\nconst roomTypeOptions = [{\n  value: 'Any',\n  label: 'Any type'\n}, {\n  value: 'Entire home/apt',\n  label: 'Entire home/apt'\n}, {\n  value: 'Private room',\n  label: 'Private room'\n}, {\n  value: 'Shared room',\n  label: 'Shared room'\n}, {\n  value: 'Hotel room',\n  label: 'Hotel room'\n}];\nconst neighborhoodOptions = [{\n  value: 'Broadway',\n  label: 'Broadway'\n}, {\n  value: 'Belltown',\n  label: 'Belltown'\n}, {\n  value: 'Wallingford',\n  label: 'Wallingford'\n}, {\n  value: 'Central Business District',\n  label: 'Central Business District'\n}, {\n  value: 'University District',\n  label: 'University District'\n}, {\n  value: 'Minor',\n  label: 'Minor'\n}, {\n  value: 'Fremont',\n  label: 'Fremont'\n}, {\n  value: 'Pike-Market',\n  label: 'Pike-Market'\n}];\n\nconst showListing = (neighborhood, listing) => {\n  for (let i = 0; i < neighborhood.selectedOptions.length; i++) {\n    if (listing['Neighborhood'] === neighborhood.selectedOptions[i].value) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nconst getSearchedListings = (listings, type, neighborhood) => {\n  let searchedResults = [...listings];\n  console.log(\"get search\", neighborhood);\n\n  if (Object.keys(type).length > 0 && type.selectedOptions.value !== 'Any') {\n    searchedResults = searchedResults.filter(listing => listing['RoomType'] === type.selectedOptions.value);\n  }\n\n  ;\n\n  if (Object.keys(neighborhood).length > 0) {\n    let result = [];\n\n    for (let i = 0; i < searchedResults.length; i++) {\n      if (showListing(neighborhood, searchedResults[i])) {\n        result.push(searchedResults[i]);\n      }\n    }\n\n    searchedResults = result;\n  }\n\n  ;\n  return searchedResults;\n};\n\nlet headers = new Headers();\nheaders.append('Content-Type', 'application/json');\nheaders.append('Origin', 'http://localhost:4002');\n\nconst Search = () => {\n  _s();\n\n  const [roomType, setRoomType] = useState([]);\n  const [neighborhood, setNeighborhood] = useState([]);\n  const [data, setData] = useState([]);\n  const [result, setResult] = useState([]);\n  useEffect(() => {\n    fetch('http://localhost:4002/listings', {\n      mode: 'cors',\n      method: 'GET',\n      headers: headers\n    }).then(response => response.json()).then(data => {\n      setData(data);\n    }).catch(error => {\n      console.error('Error fetching listings' + error);\n    });\n  }, []);\n\n  const onSearchClick = () => {\n    searchingBegun = false;\n    console.log(roomType);\n    console.log(neighborhood);\n    setResult(getSearchedListings(data, roomType, neighborhood));\n  };\n\n  const onTypeOptionChange = selectedOptions => {\n    console.log(selectedOptions);\n    searchingBegun = true;\n    setResult([]);\n    setRoomType({\n      selectedOptions\n    });\n  };\n\n  const onNeighborhoodOptionChange = selectedOptions => {\n    searchingBegun = true;\n    setResult([]);\n    setNeighborhood({\n      selectedOptions\n    });\n  };\n\n  const onSortPriceClick = () => {\n    setResult(sortOnPrice(result));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: {\n          size: 10,\n          offset: 1\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faHome\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 24\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"left-padding\",\n            children: \"Places to stay in Seattle. \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: {\n          size: 10,\n          offset: 1\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faFilter\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 24\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"left-padding\",\n            children: \"Select at least one option to begin:  \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      className: \"bottom-margin\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: {\n          size: 4,\n          offset: 1\n        },\n        children: /*#__PURE__*/_jsxDEV(Select, {\n          options: roomTypeOptions,\n          placeholder: \"Room Type...\",\n          onChange: onTypeOptionChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: {\n          size: 4\n        },\n        align: \"center\",\n        children: /*#__PURE__*/_jsxDEV(Select, {\n          options: neighborhoodOptions,\n          placeholder: \"Neighborhood...\",\n          isMulti: true,\n          onChange: onNeighborhoodOptionChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: \"2\",\n        align: \"left\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          color: \"secondary\",\n          active: roomType.length > 0 || neighborhood.length > 0,\n          disabled: roomType.length === 0 && neighborhood.length === 0,\n          onClick: () => {\n            onSearchClick();\n          },\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faSearch\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 36\n          }, this), ' ', \"Search\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: \"2\",\n          align: \"left\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            color: \"secondary\",\n            onClick: () => onSortPriceClick(),\n            children: [\"Price\", \" \", /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faSortNumericDown\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 35\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        md: {\n          size: 10,\n          offset: 1\n        },\n        children: !searchingBegun && (roomType.length > 0 || neighborhood.length > 0) && result.length === 0 && /*#__PURE__*/_jsxDEV(Alert, {\n          color: \"danger\",\n          children: \"The listings doesn't have satisfied result for your query. Modify your configuration and try again!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }, this), result.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          md: {\n            size: 10,\n            offset: 1\n          },\n          children: /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          xs: {\n            size: 3,\n            offset: 1\n          },\n          className: \"bottom-margin\",\n          children: /*#__PURE__*/_jsxDEV(\"h6\", {\n            children: [result.length, \" stays in Seattle\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Listings, {\n        listings: result\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true);\n};\n\n_s(Search, \"yBjudhhUhszD68NG6tR4kW4BI+4=\");\n\n_c = Search;\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["/Users/monkey/Documents/cs6620_db/project/CS5200Final/src/components/Search.js"],"names":["React","useState","useEffect","Select","FontAwesomeIcon","faFilter","faHome","faSearch","faSortNumericDown","Row","Col","Button","Alert","Listings","searchingBegun","sortOnPrice","listings","sorted","sort","a","b","first","substring","second","parseFloat","roomTypeOptions","value","label","neighborhoodOptions","showListing","neighborhood","listing","i","selectedOptions","length","getSearchedListings","type","searchedResults","console","log","Object","keys","filter","result","push","headers","Headers","append","Search","roomType","setRoomType","setNeighborhood","data","setData","setResult","fetch","mode","method","then","response","json","catch","error","onSearchClick","onTypeOptionChange","onNeighborhoodOptionChange","onSortPriceClick","size","offset"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Select from \"react-select\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faFilter, faHome, faSearch, faSortNumericDown } from '@fortawesome/free-solid-svg-icons';\nimport { Row, Col, Button, Alert } from \"reactstrap\";\nimport Listings from \"./Listings\";\n\nlet searchingBegun = false;\n\nconst sortOnPrice = listings => {\n    let sorted = [...listings]\n    sorted.sort((a,b) => {\n      let first = a['Price'].substring(1)\n      let second = b['Price'].substring(1)\n      return parseFloat(first) - parseFloat(second)\n    })\n    return sorted;\n  }\n\nconst roomTypeOptions = [\n    { value: 'Any', label: 'Any type'},\n    { value: 'Entire home/apt', label: 'Entire home/apt' },\n    { value: 'Private room', label: 'Private room' },\n    { value: 'Shared room', label: 'Shared room'},\n    { value: 'Hotel room', label: 'Hotel room'}\n]\n\nconst neighborhoodOptions = [\n    { value: 'Broadway', label: 'Broadway' },\n    { value: 'Belltown', label: 'Belltown' },\n    { value: 'Wallingford', label: 'Wallingford'},\n    { value: 'Central Business District', label: 'Central Business District' },\n    { value: 'University District', label: 'University District'},\n    { value: 'Minor', label: 'Minor'},\n    { value: 'Fremont', label: 'Fremont'},\n    { value: 'Pike-Market', label: 'Pike-Market'}\n]\n\nconst showListing = (neighborhood, listing) => {\n    for (let i = 0; i < neighborhood.selectedOptions.length; i++) {\n        if (listing['Neighborhood'] === neighborhood.selectedOptions[i].value) {\n            return true;\n        }\n    }\n    return false;\n}\n\nconst getSearchedListings = (listings, type, neighborhood) => {\n    let searchedResults = [...listings];\n    console.log(\"get search\", neighborhood);\n    if (Object.keys(type).length > 0 && type.selectedOptions.value !== 'Any') {\n        searchedResults = searchedResults.filter(listing => listing['RoomType'] === type.selectedOptions.value)\n    };\n    if (Object.keys(neighborhood).length > 0) {\n        let result = [];\n        for (let i = 0; i < searchedResults.length; i++) {\n            if (showListing(neighborhood, searchedResults[i])) {\n                result.push(searchedResults[i]);\n            }\n        }\n        searchedResults = result;\n    };\n    return searchedResults;\n}\n\nlet headers = new Headers();\n\nheaders.append('Content-Type', 'application/json');\nheaders.append('Origin','http://localhost:4002');\n\nconst Search = () => {\n    const [roomType, setRoomType] = useState([]);\n    const [neighborhood, setNeighborhood] = useState([]);\n    const [data, setData] = useState([]);\n    const [result, setResult] = useState([]);\n\n    useEffect(() => {\n        fetch('http://localhost:4002/listings',{\n            mode: 'cors',\n            method: 'GET',\n            headers: headers\n        })\n            .then(response => response.json())\n            .then(data => {\n                setData(data);\n            })\n            .catch(error => {\n                console.error('Error fetching listings' + error);\n            })\n    },[]);\n\n    const onSearchClick = () => {\n        searchingBegun = false;\n        console.log(roomType);\n        console.log(neighborhood);\n        setResult(getSearchedListings(data, roomType, neighborhood));\n    }\n\n    const onTypeOptionChange = selectedOptions => {\n        console.log(selectedOptions);\n        searchingBegun = true;\n        setResult([]);\n        setRoomType({ selectedOptions });\n    }\n\n    const onNeighborhoodOptionChange = selectedOptions => {\n        searchingBegun = true;\n        setResult([]);\n        setNeighborhood({ selectedOptions });\n    }\n\n    const onSortPriceClick = () => {\n        setResult(sortOnPrice(result))\n    }\n    return (\n        <>\n            <Row>\n                <Col md={{size: 10, offset: 1}}>\n                    <p><FontAwesomeIcon icon={faHome} />\n                    <span className=\"left-padding\">Places to stay in Seattle. </span></p>\n                </Col>\n            </Row>\n            <Row>\n                <Col md={{size: 10, offset: 1}}>\n                    <p><FontAwesomeIcon icon={faFilter} />\n                    <span className=\"left-padding\">Select at least one option to begin:  </span></p>\n                </Col>\n            </Row>\n            <Row className=\"bottom-margin\">\n                <Col md={{size:4, offset: 1}}>\n                    <Select options={roomTypeOptions}\n                            placeholder=\"Room Type...\"\n                            onChange={onTypeOptionChange}\n                            />\n                </Col>\n                <Col md={{size:4}} align=\"center\">\n                    <Select options={neighborhoodOptions}\n                            placeholder=\"Neighborhood...\"\n                            isMulti\n                            onChange={onNeighborhoodOptionChange}\n                            />\n                </Col>\n                <Col md=\"2\" align=\"left\">\n                    <Button color=\"secondary\"\n                            active={roomType.length > 0 || neighborhood.length > 0}\n                            disabled={roomType.length === 0 && neighborhood.length === 0}\n                            onClick={() => {\n                                onSearchClick();\n                                }}><FontAwesomeIcon icon={faSearch} />{' '}\n                        Search\n                    </Button>\n                    <Col md=\"2\" align=\"left\">\n                    <Button color=\"secondary\" onClick={() => onSortPriceClick()}>\n                        Price{\" \"}<FontAwesomeIcon icon={faSortNumericDown} /></Button>\n                </Col>\n                </Col>\n            </Row>\n            <Row>\n                <Col md={{size: 10, offset: 1}}>\n                {\n                    !searchingBegun && (roomType.length > 0 || neighborhood.length > 0) && result.length === 0 &&\n                        <Alert color=\"danger\">The listings doesn't have satisfied result for your query.\n                        Modify your configuration and try again!</Alert>\n                }\n                </Col>\n            </Row>\n            {\n                result.length > 0 \n                && \n                <>\n                    <Row>\n                        <Col md={{size: 10, offset: 1}}>\n                            <hr />\n                        </Col>\n                    </Row>\n                    <Row>\n                        <Col xs={{size:3, offset:1}} className=\"bottom-margin\">\n                            <h6>{result.length} stays in Seattle</h6>\n                        </Col>\n                    </Row>\n                    <Listings listings={result} />\n                </>\n            }\n        </>\n    )\n\n\n\n}\n\nexport default Search;"]},"metadata":{},"sourceType":"module"}